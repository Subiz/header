syntax = "proto3";

package auth;

message Empty {}

service Auth {
	rpc ReadScope(ScopeId) returns (Scope) {}
	rpc List(Empty) returns (ScopesResponse) {}
}

message Credential {
	string AccountId = 1;
	//int32 AccountPlan = 2;
	string UserId = 3;
	// scope that the user allow
	Method Method = 5;
	// set to true if this credential is generated from internal service.
	// Internal credential is trusted and have full access to any function
	// when internal is set to true, all other fields is ignored
	string ClientId = 7;
	ClientType ClientType = 8;
	// optional, used for secure service to service communication
	string APIKey = 9;
}

enum ClientType {
	Unknown = 0;
	Channel = 1;
	Widget = 2;
	Dashboard = 3;
	App = 4;
}

message Scope {
	string Id = 1;
	string Name = 2;
	string LogoUrl = 3;
	string Title = 4;
	string Description = 5;
	Method Method = 6;
}

message Method {
	// trigger
	bool UpdateTrigger = 50;
	bool DeleteTrigger = 51;
	bool CreateTrigger = 52;
	bool ReadTrigger = 53;
	bool ListTrigger = 54;
	bool ReadAllTrigger = 55;
	bool ListAllTrigger = 56;
	bool UpdateAllTrigger = 57;
	bool DeleteAllTrigger = 58;
	bool CreateAllTrigger = 59;

	// agents

	//bool AuthorizeAgentClient = 89;
	//bool RevokeAgentClient = 90;
	bool ReadAgentNotification = 105;
	bool SeenAgentNotification = 106;

	bool Ping = 107;
	// agent
	bool UpdatePasswords = 109;
	bool UpdatePassword = 108;
		bool InviteAgents = 70;
	bool UpdateAgent = 72;
	bool UpdateAgents = 73;
	bool ReadAgent = 76;
	bool ReadAgents = 77;
	bool ResetPassword = 78; // acc group

	bool UpdateAgentsPermission = 81;
	//bool ListAgentClient = 85;
	bool UpdateAgentsState = 86;


	// bool ReadAccount = 120; // default right
	bool ConfirmAccount = 120;
	//bool ListAccountClient = 121;

	// agent group
	bool CreateAgentGroups = 124;
	bool DeleteAgentGroups = 125;
	bool ReadAgentGroups = 126;
	bool UpdateAgentGroups = 127;

	// account
	bool UpdatePlan = 123; // only for subiz agent
	//bool ViewAccountReport = 125;
	//bool EnableChannel = 126;
	//bool DisableChannel = 127;
	bool CreateAccount = 129;
	bool DeleteAccount = 130;
	bool UpdateAccount  = 122;
	bool ReadAccount = 131;

	// clients
	bool ReadClient = 151;
	bool ListClient = 152;
	bool UpdateClientInfo = 153;
	bool PublishClient = 154;
	bool RegenerateClientSecret = 155;
	bool VerifyClient = 156;
	bool DeleteClient = 157;
	bool CreateClient = 158;

	// rule
	bool ReadRule = 180;
	bool WriteRule = 181;
	bool DeleteRule = 182;

	// channel

}

message ScopeId {
  string Id = 1;
}

message UserId {
	string Id = 1;
}

message ScopesResponse {
	repeated Scope Scopes = 1;
}

message UserAuth {
	string UserId = 1;
	Method Method = 2;
}
